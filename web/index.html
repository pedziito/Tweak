<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tweak</title>
<script src="qrc:///qtwebchannel/qwebchannel.js"></script>
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<style>
/* ── Reset & Base ── */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#060a14;--bg2:#0b1022;--bg3:#111827;--bg4:#0d1328;
  --border:#1a2240;--border2:#1e2d4f;
  --cyan:#06b6d4;--cyan2:#0891b2;--cyan-glow:rgba(6,182,212,.12);
  --amber:#f59e0b;--green:#10b981;--red:#ef4444;--purple:#8b5cf6;
  --text:#f1f5f9;--text2:#94a3b8;--text3:#4b5e80;
  --sidebar-w:68px;--sidebar-w-open:260px;--radius:16px;
}
html,body{height:100%;overflow:hidden;font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text)}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--text3)}

/* ── SVG Icon defaults ── */
.icon-svg{width:22px;height:22px;fill:none;stroke:currentColor;stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round;flex-shrink:0}

/* ── Layout ── */
#app{display:flex;height:100vh}

/* ── Login Page ── */
.login-page{display:flex;align-items:center;justify-content:center;width:100%;height:100vh;background:var(--bg);position:relative;overflow:hidden}
.login-page::before{content:'';position:absolute;width:500px;height:500px;background:radial-gradient(circle,rgba(6,182,212,.08) 0%,transparent 70%);top:-100px;right:-100px;pointer-events:none}
.login-page::after{content:'';position:absolute;width:500px;height:500px;background:radial-gradient(circle,rgba(139,92,246,.06) 0%,transparent 70%);bottom:-100px;left:-100px;pointer-events:none}
.login-box{background:var(--bg2);border:1px solid var(--border);border-radius:24px;padding:48px 44px;width:400px;position:relative;z-index:1;box-shadow:0 25px 80px rgba(0,0,0,.5)}
.login-box .login-logo{display:flex;align-items:center;justify-content:center;gap:14px;margin-bottom:36px}
.login-box .login-logo .logo-icon{width:48px;height:48px;background:linear-gradient(135deg,var(--cyan),var(--purple));border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:22px;color:#fff}
.login-box .login-logo h1{font-size:28px;font-weight:800;background:linear-gradient(135deg,var(--cyan),var(--purple));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
.login-box .field{margin-bottom:20px}
.login-box .field label{display:block;font-size:12px;font-weight:600;color:var(--text2);margin-bottom:8px;text-transform:uppercase;letter-spacing:.8px}
.login-box .field input{width:100%;padding:13px 16px;border-radius:12px;border:1px solid var(--border);background:var(--bg3);color:var(--text);font-size:14px;outline:none;transition:border-color .2s}
.login-box .field input:focus{border-color:var(--cyan);box-shadow:0 0 0 3px rgba(6,182,212,.1)}
.login-box .field input::placeholder{color:var(--text3)}
.login-box .login-btn{width:100%;padding:14px;border-radius:12px;border:none;background:linear-gradient(135deg,var(--cyan),var(--purple));color:#fff;font-size:15px;font-weight:700;cursor:pointer;transition:all .2s;margin-top:8px}
.login-box .login-btn:hover{filter:brightness(1.1);transform:translateY(-1px)}
.login-box .login-btn:active{transform:translateY(0)}
.login-error{color:var(--red);font-size:12px;text-align:center;margin-top:12px;min-height:18px}
.login-box .login-footer{text-align:center;margin-top:24px;font-size:11px;color:var(--text3)}

/* ── Sidebar ── */
.sidebar{
  width:var(--sidebar-w);min-width:var(--sidebar-w);
  background:var(--bg2);border-right:1px solid var(--border);
  display:flex;flex-direction:column;padding:16px 0;
  user-select:none;transition:all .3s cubic-bezier(.4,0,.2,1);
  overflow:hidden;z-index:10;position:relative;
}
.sidebar:hover{width:var(--sidebar-w-open);min-width:var(--sidebar-w-open)}
.sidebar-brand{padding:0 0 24px;display:flex;align-items:center;gap:14px;height:56px;padding-left:16px;padding-right:16px}
.sidebar-brand .logo{width:36px;height:36px;min-width:36px;background:linear-gradient(135deg,var(--cyan),var(--purple));border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px;color:#fff}
.sidebar-brand .brand-text{white-space:nowrap;overflow:hidden;opacity:0;transition:opacity .2s .05s}
.sidebar:hover .brand-text{opacity:1}
.sidebar-brand h1{font-size:20px;font-weight:800;background:linear-gradient(135deg,var(--cyan),var(--purple));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
.sidebar-brand span{font-size:10px;color:var(--text3);display:block;margin-top:1px;-webkit-text-fill-color:var(--text3)}
.nav-section{padding:0 20px;margin-bottom:6px;font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:var(--text3);white-space:nowrap;overflow:hidden;opacity:0;height:0;transition:all .2s}
.sidebar:hover .nav-section{opacity:1;height:auto;margin-bottom:6px}
.nav-items{list-style:none;padding:0 10px;margin-bottom:16px}
.nav-items li{padding:11px 12px;border-radius:12px;cursor:pointer;display:flex;align-items:center;gap:14px;font-size:13.5px;font-weight:500;color:var(--text3);transition:all .2s;white-space:nowrap;position:relative;margin-bottom:2px}
.nav-items li:hover{background:rgba(255,255,255,.04);color:var(--text)}
.nav-items li.active{background:var(--cyan-glow);color:var(--cyan);font-weight:600}
.nav-items li.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:20px;background:var(--cyan);border-radius:0 3px 3px 0}
.nav-items li .nav-icon{width:22px;min-width:22px;display:flex;align-items:center;justify-content:center}
.nav-items li .nav-label{overflow:hidden;opacity:0;transition:opacity .2s .05s}
.sidebar:hover .nav-items li .nav-label{opacity:1}
.nav-items li .badge{margin-left:auto;background:var(--cyan);color:#000;font-size:9px;font-weight:700;padding:2px 7px;border-radius:20px;opacity:0;transition:opacity .2s}
.sidebar:hover .nav-items li .badge{opacity:1}

/* ── Sidebar Sub-menu ── */
.nav-items li .nav-expand{margin-left:auto;opacity:0;transition:all .2s;font-size:9px;color:var(--text3)}
.sidebar:hover .nav-items li .nav-expand{opacity:1}
.nav-items li.expanded .nav-expand{transform:rotate(180deg);color:var(--cyan)}
.nav-sub{list-style:none;padding:0;max-height:0;overflow:hidden;transition:max-height .3s ease}
.nav-sub.open{max-height:500px}
.nav-sub li{padding:8px 12px 8px 22px;font-size:12px;color:var(--text3);cursor:pointer;transition:all .15s;border-radius:8px;margin:1px 0;display:flex;align-items:center;gap:10px}
.nav-sub li:hover{color:var(--text);background:rgba(255,255,255,.03)}
.nav-sub li.active{color:var(--cyan);font-weight:600}
.nav-sub li .sub-count{margin-left:auto;font-size:10px;opacity:.6}
.nav-sub li .sub-icon{width:16px;min-width:16px;height:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.nav-sub li .sub-icon svg{width:14px;height:14px}
.nav-sub li.active .sub-icon{color:var(--cyan)}
/* Pinned single category (sidebar collapsed + category selected) */
.nav-pinned{list-style:none;padding:0 10px;max-height:0;overflow:hidden;transition:max-height .3s ease}
.nav-pinned.show{max-height:50px}
.nav-pinned li{padding:8px 12px;font-size:12px;color:var(--cyan);font-weight:600;cursor:pointer;border-radius:8px;display:flex;align-items:center;gap:10px}
.nav-pinned li .sub-icon{width:16px;min-width:16px;height:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--cyan)}
.nav-pinned li .sub-icon svg{width:14px;height:14px}
.nav-pinned .nav-label{overflow:hidden;opacity:0;transition:opacity .2s .05s}
.sidebar:hover .nav-pinned .nav-label{opacity:1}
.nav-pinned .sub-count{margin-left:auto;font-size:10px;opacity:0;transition:opacity .2s .05s}
.sidebar:hover .nav-pinned .sub-count{opacity:.6}

/* ── Save Credentials Checkbox ── */
.save-creds{display:flex;align-items:center;gap:9px;margin-top:12px;margin-bottom:4px;cursor:pointer;user-select:none}
.save-creds input{display:none}
.save-creds .check-box{width:18px;height:18px;border-radius:5px;border:1.5px solid var(--border);background:var(--bg);display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}
.save-creds input:checked~.check-box{background:var(--cyan);border-color:var(--cyan)}
.save-creds input:checked~.check-box svg{opacity:1}
.save-creds .check-box svg{width:12px;height:12px;stroke:#000;stroke-width:3;opacity:0;transition:opacity .15s}
.save-creds .check-label{font-size:12px;color:var(--text3);transition:color .2s}
.save-creds:hover .check-label{color:var(--text2)}
.sidebar-footer{margin-top:auto;padding:12px 10px;border-top:1px solid var(--border)}
.admin-badge{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap}
.admin-badge .admin-label{opacity:0;overflow:hidden;transition:opacity .2s .05s}
.sidebar:hover .admin-badge .admin-label{opacity:1}
.admin-badge.is-admin{background:rgba(16,185,129,.1);color:var(--green)}
.admin-badge.not-admin{background:rgba(239,68,68,.1);color:var(--red)}
.admin-badge:hover{filter:brightness(1.2)}
.user-info{display:flex;align-items:center;gap:10px;padding:10px 12px;margin-bottom:4px;white-space:nowrap}
.user-info .user-avatar{width:28px;height:28px;min-width:28px;border-radius:8px;background:linear-gradient(135deg,var(--purple),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff}
.user-info .user-name{font-size:12px;font-weight:600;color:var(--text2);opacity:0;overflow:hidden;transition:opacity .2s .05s}
.sidebar:hover .user-info .user-name{opacity:1}
.logout-btn{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;font-size:12px;font-weight:500;cursor:pointer;color:var(--text3);transition:all .2s;white-space:nowrap;border:none;background:none;width:100%}
.logout-btn:hover{color:var(--red);background:rgba(239,68,68,.08)}
.logout-btn .logout-label{opacity:0;overflow:hidden;transition:opacity .2s .05s}
.sidebar:hover .logout-btn .logout-label{opacity:1}

/* ── Main Area ── */
.main{flex:1;overflow-y:auto;padding:28px 36px;background:var(--bg)}
.page-header{margin-bottom:28px}
.page-header h2{font-size:28px;font-weight:800;margin-bottom:4px;letter-spacing:-.5px}
.page-header p{color:var(--text3);font-size:13px}

/* ── Cards ── */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:22px;transition:all .3s ease}
.card:hover{border-color:var(--border2);box-shadow:0 4px 24px rgba(0,0,0,.2)}
.card-title{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:16px}

/* ── Grid helpers ── */
.grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
@media(max-width:1200px){.grid-4{grid-template-columns:repeat(2,1fr)}.grid-3{grid-template-columns:repeat(2,1fr)}}

/* ── Stat Cards ── */
.stat-card{text-align:center;padding:28px 16px;position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:60px;height:2px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);border-radius:2px}
.stat-card .value{font-size:34px;font-weight:900;background:linear-gradient(135deg,var(--cyan),var(--purple));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
.stat-card .label{font-size:11px;color:var(--text3);margin-top:6px;text-transform:uppercase;letter-spacing:.5px;font-weight:600}

/* ── Score Ring ── */
.score-ring{position:relative;width:140px;height:140px;margin:0 auto 12px}
.score-ring svg{width:100%;height:100%;transform:rotate(-90deg)}
.score-ring .bg{fill:none;stroke:var(--border);stroke-width:8}
.score-ring .fg{fill:none;stroke-width:8;stroke-linecap:round;transition:stroke-dashoffset .8s ease}
.score-ring .val{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:36px;font-weight:900;color:var(--cyan)}
.score-ring .val-unit{font-size:16px;font-weight:600;opacity:.6}
.score-label{text-align:center;font-size:14px;font-weight:600;color:var(--text2)}
.score-sub{text-align:center;font-size:11px;color:var(--text3);margin-top:4px}
.gauge-card{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:28px 16px}

/* ── Monitor Bars ── */
.monitor-bar{margin-bottom:18px}
.monitor-bar .bar-header{display:flex;justify-content:space-between;margin-bottom:8px;font-size:13px}
.monitor-bar .bar-header .name{color:var(--text2);font-weight:500}
.monitor-bar .bar-header .pct{color:var(--cyan);font-weight:700;font-size:14px}
.monitor-bar .track{height:5px;background:var(--bg);border-radius:3px;overflow:hidden}
.monitor-bar .fill{height:100%;border-radius:3px;transition:width .5s ease;background:linear-gradient(90deg,var(--cyan),var(--purple))}

/* ── Hardware Info ── */
.hw-row{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--border);font-size:13px}
.hw-row:last-child{border-bottom:none}
.hw-row .hw-label{color:var(--text3);font-weight:500}
.hw-row .hw-value{color:var(--text);font-weight:600;text-align:right;max-width:60%}

/* ── Tweaks Page ── */
.filter-bar{display:flex;gap:12px;margin-bottom:22px;flex-wrap:wrap;align-items:center}
.search-box{flex:1;min-width:200px;padding:11px 18px;border-radius:12px;border:1px solid var(--border);background:var(--bg3);color:var(--text);font-size:14px;outline:none;transition:all .2s}
.search-box:focus{border-color:var(--cyan);box-shadow:0 0 0 3px rgba(6,182,212,.08)}
.search-box::placeholder{color:var(--text3)}
.cat-btn{padding:8px 18px;border-radius:20px;border:1px solid var(--border);background:transparent;color:var(--text3);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap}
.cat-btn:hover{border-color:var(--cyan);color:var(--text)}
.cat-btn.active{background:var(--cyan);color:#000;border-color:var(--cyan)}
.cat-count{margin-left:5px;opacity:.6}

.tweak-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:14px}
.tweak-card{display:flex;flex-direction:column;padding:20px 22px;min-height:140px}
.tweak-card .tc-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px}
.tweak-card .tc-name{font-size:14.5px;font-weight:700;color:var(--text);flex:1;margin-right:10px}
.tweak-card .tc-desc{font-size:12.5px;color:var(--text3);line-height:1.6;flex:1}
.tweak-card .tc-bottom{display:flex;align-items:center;gap:8px;margin-top:auto;padding-top:14px}
.tweak-card .tc-badge{font-size:10px;font-weight:700;padding:3px 10px;border-radius:20px;text-transform:uppercase;letter-spacing:.5px}
.tweak-card .tc-badge.rec{background:rgba(16,185,129,.1);color:var(--green)}
.tweak-card .tc-badge.risk-low{background:rgba(6,182,212,.1);color:var(--cyan)}
.tweak-card .tc-badge.risk-medium{background:rgba(245,158,11,.1);color:var(--amber)}
.tweak-card .tc-badge.risk-high{background:rgba(239,68,68,.1);color:var(--red)}

/* Toggle Switch */
.toggle{position:relative;width:44px;height:24px;flex-shrink:0;cursor:pointer}
.toggle input{display:none}
.toggle .slider{position:absolute;inset:0;background:var(--bg);border:1px solid var(--border);border-radius:12px;transition:all .3s}
.toggle .slider::before{content:'';position:absolute;width:18px;height:18px;left:2px;top:2px;background:var(--text3);border-radius:50%;transition:all .3s}
.toggle input:checked+.slider{background:var(--cyan);border-color:var(--cyan)}
.toggle input:checked+.slider::before{transform:translateX(20px);background:#fff}

/* ── Action Buttons ── */
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 22px;border-radius:12px;border:none;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}
.btn-cyan{background:var(--cyan);color:#000}.btn-cyan:hover{background:var(--cyan2);transform:translateY(-1px)}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text2)}.btn-outline:hover{border-color:var(--cyan);color:var(--cyan)}
.btn-red{background:rgba(239,68,68,.12);color:var(--red);border:1px solid rgba(239,68,68,.2)}.btn-red:hover{background:rgba(239,68,68,.2)}
.btn-green{background:rgba(16,185,129,.12);color:var(--green);border:1px solid rgba(16,185,129,.2)}.btn-green:hover{background:rgba(16,185,129,.2)}

/* ── Batch Popup ── */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:999}
.batch-popup{background:var(--bg2);border:1px solid var(--border);border-radius:20px;padding:36px;width:520px;max-height:80vh;overflow-y:auto;box-shadow:0 25px 80px rgba(0,0,0,.5)}
.batch-popup h3{font-size:18px;font-weight:700;margin-bottom:16px}
.batch-item{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--border);font-size:13px}
.batch-item:last-child{border-bottom:none}
.batch-item .bi-icon{width:22px;text-align:center;font-size:14px}
.batch-item .bi-icon.done{color:var(--green)}
.batch-item .bi-icon.active{color:var(--cyan);animation:pulse 1s infinite}
.batch-item .bi-icon.pending{color:var(--text3)}
.batch-item .bi-name{flex:1;color:var(--text)}
.batch-item .bi-status{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px}
.progress-bar{height:5px;background:var(--bg);border-radius:3px;overflow:hidden;margin:16px 0}
.progress-bar .fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--green));border-radius:3px;transition:width .3s}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

/* ── Quick Actions ── */
.quick-actions{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.qa-btn{padding:16px;border-radius:14px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:13px;font-weight:600;cursor:pointer;transition:all .25s;text-align:center;display:flex;align-items:center;justify-content:center;gap:10px}
.qa-btn:hover{border-color:var(--cyan);color:var(--cyan);background:var(--cyan-glow);transform:translateY(-2px)}
.qa-btn .icon-svg{width:18px;height:18px}

/* ── Boost Page ── */
.boost-card{padding:32px;text-align:center}
.boost-card .boost-icon{margin-bottom:16px;display:flex;justify-content:center}
.boost-card .boost-icon .icon-svg{width:44px;height:44px;color:var(--cyan)}
.boost-card h3{font-size:17px;font-weight:700;margin-bottom:8px}
.boost-card p{font-size:13px;color:var(--text3);margin-bottom:20px;line-height:1.5}

/* ── Games / Pro Settings ── */
.pro-player-card{padding:0;overflow:hidden;transition:all .25s;border:1px solid var(--border)}
.pro-player-card:hover{border-color:var(--cyan);transform:translateY(-2px);box-shadow:0 8px 28px rgba(6,182,212,.1)}
.pro-card-top{padding:20px 20px 16px;display:flex;align-items:center;gap:14px}
.pro-avatar{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--cyan),var(--purple));display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800;color:#000;flex-shrink:0;overflow:hidden}
.pro-avatar img{width:100%;height:100%;object-fit:cover;border-radius:50%}
.pro-info{flex:1}
.pro-name{font-size:16px;font-weight:700}
.pro-team{font-size:12px;color:var(--text3);margin-top:2px}
.pro-link{display:inline-flex;align-items:center;gap:5px;font-size:11px;font-weight:600;color:var(--cyan);cursor:pointer;opacity:.7;transition:opacity .2s;text-decoration:none}
.pro-link:hover{opacity:1}
.pro-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:1px;background:var(--border)}
.pro-stat{padding:12px 14px;background:var(--bg2)}
.pro-stat .ps-label{font-size:10px;color:var(--text3);margin-bottom:3px;text-transform:uppercase;letter-spacing:.5px}
.pro-stat .ps-value{font-size:13px;font-weight:700;color:var(--text)}
.pro-crosshair-cell{transition:background .2s}
.pro-crosshair-cell:hover{background:var(--cyan-glow)!important}
.crosshair-box{display:flex;align-items:center;gap:12px;padding:14px 18px;border-radius:12px;background:var(--bg);border:1px solid var(--border);margin-bottom:10px;cursor:pointer;transition:all .2s}
.crosshair-box:hover{border-color:var(--cyan);background:var(--cyan-glow)}
.crosshair-box .ch-player{font-size:13px;font-weight:600;color:var(--text);min-width:100px}
.crosshair-box .ch-code{font-family:'Courier New',monospace;font-size:12px;color:var(--cyan);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.crosshair-box .ch-copy{font-size:11px;color:var(--text3);font-weight:600;flex-shrink:0}
.copied-flash{color:var(--green)!important}
.optimize-bar{padding:18px 22px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between;gap:16px}
.section-title{font-size:15px;font-weight:700;color:var(--text);margin-bottom:14px;display:flex;align-items:center;gap:8px}
.section-title .icon-svg{width:18px;height:18px;color:var(--cyan)}
.pro-search{width:100%;padding:12px 16px;border-radius:10px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:13px;margin-bottom:16px;outline:none;transition:border-color .2s}
.pro-search:focus{border-color:var(--cyan)}
.pro-search::placeholder{color:var(--text3)}
.player-count{font-size:12px;color:var(--text3);font-weight:500;margin-left:auto}

/* ── Settings ── */
.setting-row{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid var(--border)}
.setting-row:last-child{border-bottom:none}
.setting-row .sr-info h4{font-size:14px;font-weight:600;margin-bottom:3px}
.setting-row .sr-info p{font-size:12px;color:var(--text3)}

/* ── Score tier colors ── */
.score-s{color:var(--green)}.score-a{color:var(--cyan)}.score-b{color:var(--amber)}.score-c{color:var(--red)}

/* ── Toast notification ── */
.toast{position:fixed;bottom:28px;right:28px;background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:14px 24px;font-size:13px;font-weight:600;color:var(--cyan);z-index:1000;box-shadow:0 12px 40px rgba(0,0,0,.5);animation:slideUp .3s ease}
@keyframes slideUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}

/* ── Empty state ── */
.empty-state{text-align:center;padding:60px;color:var(--text3)}
.empty-state .icon-svg{width:48px;height:48px;margin:0 auto 16px;opacity:.4}
</style>
</head>
<body>
<div id="app">

  <!-- ═══════════ LOGIN PAGE ═══════════ -->
  <div class="login-page" v-if="!loggedIn">
    <div class="login-box">
      <div class="login-logo">
        <div class="logo-icon">T</div>
        <h1>Tweak</h1>
      </div>

      <!-- Tab switcher -->
      <div style="display:flex;gap:0;margin-bottom:28px;border-radius:12px;overflow:hidden;border:1px solid var(--border)">
        <button @click="authTab='login'" :style="{flex:1,padding:'11px',border:'none',fontSize:'13px',fontWeight:600,cursor:'pointer',background:authTab==='login'?'var(--cyan)':'var(--bg3)',color:authTab==='login'?'#000':'var(--text3)',transition:'all .2s'}">Sign In</button>
        <button @click="authTab='activate'" :style="{flex:1,padding:'11px',border:'none',fontSize:'13px',fontWeight:600,cursor:'pointer',background:authTab==='activate'?'var(--cyan)':'var(--bg3)',color:authTab==='activate'?'#000':'var(--text3)',transition:'all .2s'}">Sign Up</button>
      </div>

      <!-- Login tab -->
      <form v-if="authTab==='login'" @submit.prevent="doLogin">
        <div class="field">
          <label>Username</label>
          <input type="text" v-model="loginUser" placeholder="Enter your username" autofocus @input="onLoginUserInput">
        </div>
        <div class="field">
          <label>Password</label>
          <input type="password" v-model="loginPass" placeholder="Enter your password">
        </div>
        <label class="save-creds" @click.stop>
          <input type="checkbox" v-model="saveCredentials" @change="onSaveCredsToggle">
          <span class="check-box"><svg viewBox="0 0 24 24" fill="none"><polyline points="20 6 9 17 4 12"/></svg></span>
          <span class="check-label">Save Credentials</span>
        </label>
        <button class="login-btn" type="submit" :disabled="authLoading">
          {{authLoading ? 'Signing in...' : 'Sign In'}}
        </button>
        <div class="login-error">{{loginError}}</div>

        <!-- HWID Status Indicator -->
        <div v-if="hwidStatus==='ok'" style="margin-top:10px;padding:8px 14px;border-radius:8px;background:rgba(255,255,255,.03);border:1px solid var(--border);font-size:12px;font-style:italic;color:var(--text3)">{{hwidStatusMsg}}</div>
        <div v-if="hwidStatus==='mismatch'" style="margin-top:10px;padding:8px 14px;border-radius:8px;background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.25);font-size:12px;font-weight:600;color:var(--red)">{{hwidStatusMsg}}</div>
      </form>

      <!-- Activate tab -->
      <form v-if="authTab==='activate'" @submit.prevent="doActivate">
        <div class="field">
          <label>License Key</label>
          <input type="text" v-model="licenseKey" placeholder="LICENSE-XXXX-XXXX-XXXX" style="font-family:monospace;letter-spacing:1px">
        </div>
        <div class="field">
          <label>Choose Username</label>
          <input type="text" v-model="activateUser" placeholder="Pick a username">
        </div>
        <div class="field">
          <label>Choose Password</label>
          <input type="password" v-model="activatePass" placeholder="Pick a password">
        </div>
        <div class="field" style="margin-bottom:8px">
          <label>Your Hardware ID</label>
          <input type="text" :value="hwidValue" readonly style="opacity:.6;cursor:default;font-family:monospace;font-size:12px">
        </div>
        <button class="login-btn" type="submit" :disabled="authLoading">
          {{authLoading ? 'Activating...' : 'Activate License'}}
        </button>
        <div class="login-error" :style="{color: activateSuccess ? 'var(--green)' : 'var(--red)'}">{{activateMsg}}</div>
      </form>

      <div class="login-footer">Tweak v5.0.0 &mdash; PC Optimization Suite</div>
    </div>
  </div>

  <!-- ═══════════ APP ═══════════ -->
  <template v-if="loggedIn">

  <!-- Sidebar -->
  <aside class="sidebar" @mouseenter="sidebarHovered=true" @mouseleave="sidebarHovered=false">
    <div class="sidebar-brand">
      <div class="logo">T</div>
      <div class="brand-text">
        <h1>Tweak</h1>
        <span>v5.0.0</span>
      </div>
    </div>

    <div class="nav-section">Menu</div>
    <ul class="nav-items">
      <li v-for="p in pages" :key="p.id"
          :class="{active: page===p.id, expanded: p.id==='tweaks' && sidebarHovered && page==='tweaks'}"
          @click="handleNavClick(p)">
        <span class="nav-icon" v-html="p.svg"></span>
        <span class="nav-label">{{p.label}}</span>
        <span v-if="p.id==='tweaks' && appliedCount>0" class="badge">{{appliedCount}}</span>
        <span v-if="p.id==='tweaks'" class="nav-expand">&#9660;</span>
      </li>
      <!-- Full sub-menu (visible on sidebar hover when on tweaks page) -->
      <ul class="nav-sub" :class="{open: sidebarHovered && page==='tweaks'}">
        <li :class="{active: activeCat==='All'}" @click="selectCategory('All')">
          <span class="sub-icon" v-html="catIcon('All')"></span>
          <span>All</span>
          <span class="sub-count">{{tweaks.length}}</span>
        </li>
        <template v-for="c in categories" :key="c">
          <li v-if="c!=='All'" :class="{active: activeCat===c}" @click="selectCategory(c)">
            <span class="sub-icon" v-html="catIcon(c)"></span>
            <span>{{c}}</span>
            <span class="sub-count">{{tweakCountByCat(c)}}</span>
          </li>
        </template>
      </ul>
      <!-- Pinned category (sidebar collapsed + category selected) -->
      <ul class="nav-pinned" :class="{show: !sidebarHovered && page==='tweaks' && catPinned}">
        <li>
          <span class="sub-icon" v-html="catIcon(activeCat)"></span>
          <span class="nav-label">{{activeCat}}</span>
          <span class="sub-count nav-label">{{activeCat==='All' ? tweaks.length : tweakCountByCat(activeCat)}}</span>
        </li>
      </ul>
    </ul>

    <div class="nav-section">System</div>
    <ul class="nav-items">
      <li @click="page='settings'" :class="{active:page==='settings'}">
        <span class="nav-icon"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg></span>
        <span class="nav-label">Settings</span>
      </li>
    </ul>

    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">{{currentUser.charAt(0).toUpperCase()}}</div>
        <span class="user-name">{{currentUser}}</span>
      </div>
      <div class="admin-badge" :class="isAdmin?'is-admin':'not-admin'" @click="!isAdmin && doRequestAdmin()">
        <span class="nav-icon">
          <svg class="icon-svg" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        </span>
        <span class="admin-label">{{isAdmin ? 'Admin' : 'No Admin'}}</span>
      </div>
      <button class="logout-btn" @click="doLogout">
        <span class="nav-icon"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></span>
        <span class="logout-label">Sign Out</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main">

    <!-- ═══════════ DASHBOARD ═══════════ -->
    <template v-if="page==='dashboard'">
      <div class="page-header">
        <h2>Dashboard</h2>
        <p>System overview and performance scoring</p>
      </div>

      <div class="grid-4" style="margin-bottom:20px">
        <div class="card stat-card">
          <div class="value">{{appliedCount}}</div>
          <div class="label">Tweaks Applied</div>
        </div>
        <div class="card stat-card">
          <div class="value">{{recommendedCount}}</div>
          <div class="label">Recommended</div>
        </div>
        <div class="card stat-card">
          <div class="value">{{tweaks.length}}</div>
          <div class="label">Total Tweaks</div>
        </div>
        <div class="card stat-card">
          <div class="value">{{categories.length}}</div>
          <div class="label">Categories</div>
        </div>
      </div>

      <div class="grid-4" style="margin-bottom:20px">
        <!-- Performance Score Ring -->
        <div class="card gauge-card">
          <div class="card-title">Performance Score</div>
          <div class="score-ring">
            <svg viewBox="0 0 100 100">
              <defs><linearGradient id="scoreGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#06b6d4"/><stop offset="100%" stop-color="#8b5cf6"/></linearGradient></defs>
              <circle class="bg" cx="50" cy="50" r="42"/>
              <circle class="fg" cx="50" cy="50" r="42"
                stroke="url(#scoreGrad)"
                :stroke-dasharray="264"
                :stroke-dashoffset="264 - (264 * (scores.performanceScore||0) / 100)"/>
            </svg>
            <div class="val">{{scores.performanceScore||0}}</div>
          </div>
          <div class="score-label">Tier: <strong :class="'score-'+((scores.tier||'c').charAt(0).toLowerCase())">{{scores.tier||'?'}}</strong></div>
          <div v-if="scores.bottleneck" class="score-sub">Bottleneck: {{scores.bottleneck}}</div>
        </div>

        <!-- CPU Usage Ring -->
        <div class="card gauge-card">
          <div class="card-title">CPU Usage</div>
          <div class="score-ring">
            <svg viewBox="0 0 100 100">
              <defs><linearGradient id="cpuGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#06b6d4"/><stop offset="100%" stop-color="#10b981"/></linearGradient></defs>
              <circle class="bg" cx="50" cy="50" r="42"/>
              <circle class="fg" cx="50" cy="50" r="42"
                stroke="url(#cpuGrad)"
                :stroke-dasharray="264"
                :stroke-dashoffset="264 - (264 * Math.min(Math.round(monitor.cpuUsage||0),100) / 100)"/>
            </svg>
            <div class="val">{{Math.round(monitor.cpuUsage||0)}}<span class="val-unit">%</span></div>
          </div>
          <div class="score-label">{{sysinfo.cpuName||'CPU'}}</div>
          <div class="score-sub">{{sysinfo.cpuCores||'?'}} cores / {{sysinfo.cpuThreads||'?'}} threads</div>
        </div>

        <!-- RAM Usage Ring -->
        <div class="card gauge-card">
          <div class="card-title">RAM Usage</div>
          <div class="score-ring">
            <svg viewBox="0 0 100 100">
              <defs><linearGradient id="ramGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#8b5cf6"/><stop offset="100%" stop-color="#ec4899"/></linearGradient></defs>
              <circle class="bg" cx="50" cy="50" r="42"/>
              <circle class="fg" cx="50" cy="50" r="42"
                stroke="url(#ramGrad)"
                :stroke-dasharray="264"
                :stroke-dashoffset="264 - (264 * Math.min(Math.round(monitor.ramUsage||0),100) / 100)"/>
            </svg>
            <div class="val" style="color:var(--purple)">{{Math.round(monitor.ramUsage||0)}}<span class="val-unit">%</span></div>
          </div>
          <div class="score-label">{{(monitor.ramUsedGb||0).toFixed(1)}} / {{(monitor.ramTotalGb||0).toFixed(1)}} GB</div>
          <div class="score-sub">{{sysinfo.ramType||''}} {{sysinfo.ramSpeedMhz ? '@ '+sysinfo.ramSpeedMhz+' MHz' : ''}}</div>
        </div>

        <!-- Storage Usage Ring -->
        <div class="card gauge-card">
          <div class="card-title">Storage Usage</div>
          <div class="score-ring">
            <svg viewBox="0 0 100 100">
              <defs><linearGradient id="storGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f59e0b"/><stop offset="100%" stop-color="#ef4444"/></linearGradient></defs>
              <circle class="bg" cx="50" cy="50" r="42"/>
              <circle class="fg" cx="50" cy="50" r="42"
                stroke="url(#storGrad)"
                :stroke-dasharray="264"
                :stroke-dashoffset="264 - (264 * Math.min(Math.round(monitor.storageUsage||0),100) / 100)"/>
            </svg>
            <div class="val" style="color:var(--amber)">{{Math.round(monitor.storageUsage||0)}}<span class="val-unit">%</span></div>
          </div>
          <div class="score-label">{{sysinfo.storageText||'Storage'}}</div>
          <div class="score-sub">Uptime: {{monitor.uptimeText||'—'}}</div>
        </div>
      </div>

      <!-- Hardware -->
      <div class="card">
        <div class="card-title">Hardware Information</div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:18px">
          <!-- Column 1: OS-Level -->
          <div>
            <div style="font-size:9px;font-weight:700;color:var(--cyan);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:10px">OS Level</div>
            <div class="hw-row"><span class="hw-label">CPU</span><span class="hw-value">{{sysinfo.cpuName||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">Cores / Threads</span><span class="hw-value">{{sysinfo.cpuCores||'?'}} / {{sysinfo.cpuThreads||'?'}}</span></div>
            <div class="hw-row"><span class="hw-label">GPU</span><span class="hw-value">{{sysinfo.gpuName||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">RAM</span><span class="hw-value">{{sysinfo.ramText||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">Storage</span><span class="hw-value">{{sysinfo.storageText||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">OS</span><span class="hw-value">{{sysinfo.osVersion||'—'}}</span></div>
          </div>
          <!-- Column 2: Low-Level -->
          <div>
            <div style="font-size:9px;font-weight:700;color:var(--purple);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:10px">Low Level</div>
            <div class="hw-row"><span class="hw-label">RAM Type</span><span class="hw-value">{{sysinfo.ramType||'—'}} <span v-if="sysinfo.ramSpeedMhz">@ {{sysinfo.ramSpeedMhz}} MHz</span></span></div>
            <div class="hw-row"><span class="hw-label">GPU VRAM</span><span class="hw-value">{{sysinfo.gpuVramMb ? (sysinfo.gpuVramMb >= 1024 ? (sysinfo.gpuVramMb/1024).toFixed(0)+' GB' : sysinfo.gpuVramMb+' MB') : '—'}}</span></div>
            <div class="hw-row"><span class="hw-label">GPU Driver</span><span class="hw-value">{{sysinfo.gpuDriverVersion||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">L2 Cache</span><span class="hw-value">{{sysinfo.cpuL2CacheKb ? (sysinfo.cpuL2CacheKb >= 1024 ? (sysinfo.cpuL2CacheKb/1024).toFixed(0)+' MB' : sysinfo.cpuL2CacheKb+' KB') : '—'}}</span></div>
            <div class="hw-row"><span class="hw-label">L3 Cache</span><span class="hw-value">{{sysinfo.cpuL3CacheKb ? (sysinfo.cpuL3CacheKb/1024).toFixed(0)+' MB' : '—'}}</span></div>
            <div class="hw-row"><span class="hw-label">Motherboard</span><span class="hw-value">{{sysinfo.motherboardName||'—'}}</span></div>
          </div>
          <!-- Column 3: Firmware -->
          <div>
            <div style="font-size:9px;font-weight:700;color:var(--amber);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:10px">Firmware / SMBIOS</div>
            <div class="hw-row"><span class="hw-label">BIOS</span><span class="hw-value">{{sysinfo.biosVersion||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">BIOS Date</span><span class="hw-value">{{sysinfo.biosDate||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">TPM</span><span class="hw-value">{{sysinfo.tpmVersion||'—'}}</span></div>
            <div class="hw-row"><span class="hw-label">Secure Boot</span><span class="hw-value" :style="{color: sysinfo.secureBootEnabled ? 'var(--green)' : 'var(--text3)'}">{{sysinfo.secureBootEnabled ? 'Enabled' : 'Disabled'}}</span></div>
            <div class="hw-row"><span class="hw-label">Chassis</span><span class="hw-value">{{sysinfo.chassisType||'—'}}</span></div>
          </div>
        </div>
      </div>
    </template>

    <!-- ═══════════ TWEAKS PAGE ═══════════ -->
    <template v-if="page==='tweaks'">
      <div class="page-header" style="display:flex;justify-content:space-between;align-items:flex-start">
        <div>
          <h2>Optimizations</h2>
          <p>{{filteredTweaks.length}} tweaks &middot; {{appliedCount}} applied</p>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <button class="btn btn-cyan" @click="startBatchApply" :disabled="unappliedVisible.length===0">
            <svg class="icon-svg" style="width:14px;height:14px" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
            Apply Visible ({{unappliedVisible.length}})
          </button>
          <button class="btn btn-outline" @click="confirmRevertAll" title="Revert all tweaks to defaults">
            <svg class="icon-svg" style="width:14px;height:14px" viewBox="0 0 24 24"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
            Revert All
          </button>
        </div>
      </div>

      <!-- Unsaved changes bar -->
      <div class="save-bar" v-if="hasUnsavedTweaks">
        <div class="sb-text">
          <svg class="icon-svg" style="width:16px;height:16px" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          You have {{unsavedCount}} unsaved change{{unsavedCount>1?'s':''}}
        </div>
        <div class="sb-actions">
          <button class="btn btn-outline" style="padding:7px 16px;font-size:12px" @click="discardTweakChanges">Discard</button>
          <button class="btn btn-cyan" style="padding:7px 16px;font-size:12px" @click="saveTweakChanges">
            <svg class="icon-svg" style="width:13px;height:13px" viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
            Save
          </button>
        </div>
      </div>

      <!-- Search bar -->
      <div class="filter-bar">
        <input class="search-box" v-model="search" placeholder="Search tweaks...">
      </div>

      <div class="tweak-grid">
        <div class="card tweak-card" v-for="t in filteredTweaks" :key="t.row"
             :class="{'just-applied': tweakAnimState[t.row]==='applied', 'just-reverted': tweakAnimState[t.row]==='reverted', 'applying': tweakAnimState[t.row]==='applying'}">
          <div class="tc-top">
            <span class="tc-name">{{t.name}}</span>
            <label class="toggle" @click.stop>
              <input type="checkbox" :checked="t.applied" @change="handleToggleTweak(t)">
              <span class="slider"></span>
            </label>
          </div>
          <div class="tc-desc">{{t.description}}</div>
          <div class="tc-bottom">
            <span class="tc-badge" :class="'risk-'+t.risk">{{t.risk}}</span>
            <span v-if="t.recommended" class="tc-badge rec">Recommended</span>
            <span v-if="t.requiresAdmin" style="font-size:10px;color:var(--amber);display:flex;align-items:center;gap:3px">
              <svg class="icon-svg" style="width:12px;height:12px" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg> Admin
            </span>
            <span v-if="t.verified" style="font-size:10px;color:var(--green);display:flex;align-items:center;gap:3px">
              <svg class="icon-svg" style="width:12px;height:12px" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            </span>
            <span class="tweak-status" :class="tweakStatusClass(t)" v-if="tweakStatusText(t)">{{tweakStatusText(t)}}</span>
          </div>
          <!-- Activity log line -->
          <div class="tweak-log" :class="{visible: tweakLogMsg[t.row]}">
            <svg class="icon-svg" style="width:11px;height:11px" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            {{tweakLogMsg[t.row]}}
          </div>
        </div>
      </div>

      <div v-if="filteredTweaks.length===0" class="empty-state">
        <svg class="icon-svg" style="width:48px;height:48px;margin:0 auto 16px;display:block" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <p>No tweaks match your search</p>
      </div>
    </template>

    <!-- ═══════════ BOOST PAGE ═══════════ -->
    <template v-if="page==='boost'">
      <div class="page-header">
        <h2>Boost Up</h2>
        <p>One-click optimization profiles for maximum performance</p>
      </div>

      <div class="grid-3" style="margin-bottom:20px">
        <div class="card boost-card">
          <div class="boost-icon"><svg class="icon-svg" viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg></div>
          <h3>Gaming Boost</h3>
          <p>Apply all gaming-related optimizations for maximum FPS</p>
          <button class="btn btn-cyan" @click="doApplyGaming">Apply Gaming Tweaks</button>
        </div>
        <div class="card boost-card">
          <div class="boost-icon"><svg class="icon-svg" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></div>
          <h3>Recommended</h3>
          <p>Apply all safe, recommended optimizations</p>
          <button class="btn btn-green" @click="doApplyRecommended">Apply Recommended</button>
        </div>
        <div class="card boost-card">
          <div class="boost-icon"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg></div>
          <h3>Full Boost</h3>
          <p>Apply ALL available tweaks (advanced users only)</p>
          <button class="btn btn-red" @click="startFullBatchApply">Apply All Tweaks</button>
        </div>
      </div>

      <div class="card" style="margin-bottom:20px">
        <div class="card-title">Score Breakdown</div>
        <div class="grid-4">
          <div style="text-align:center">
            <div style="font-size:28px;font-weight:900;color:var(--cyan)">{{scores.cpuScore||0}}</div>
            <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;font-weight:600">CPU Score</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:28px;font-weight:900;color:var(--purple)">{{scores.gpuScore||0}}</div>
            <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;font-weight:600">GPU Score</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:28px;font-weight:900;color:var(--green)">{{scores.ramScore||0}}</div>
            <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;font-weight:600">RAM Score</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:28px;font-weight:900;color:var(--amber)">{{scores.storageScore||0}}</div>
            <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;font-weight:600">Storage Score</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Maintenance</div>
        <div class="quick-actions">
          <div class="qa-btn" @click="doClearTemp"><svg class="icon-svg" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg> Clear Temp Files</div>
          <div class="qa-btn" @click="doFlushDns"><svg class="icon-svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg> Flush DNS Cache</div>
          <div class="qa-btn" @click="doVerifyAll"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> Verify All Tweaks</div>
          <div class="qa-btn" @click="doRestoreAll"><svg class="icon-svg" viewBox="0 0 24 24"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg> Restore Defaults</div>
        </div>
      </div>
    </template>

    <!-- ═══════════ GAMES PAGE (CS2) ═══════════ -->
    <template v-if="page==='games'">
      <div class="page-header">
        <h2>Counter-Strike 2</h2>
        <p>Pro player settings, crosshair codes & optimization</p>
      </div>

      <!-- Optimize Bar -->
      <div class="card optimize-bar">
        <div>
          <div style="font-size:15px;font-weight:700;margin-bottom:4px">Optimize for CS2</div>
          <div style="font-size:12px;color:var(--text3)">Apply Gaming & Network tweaks for maximum FPS and lowest latency</div>
        </div>
        <button class="btn btn-cyan" @click="applyGameProfile(['Gaming','Network'])" style="white-space:nowrap">
          <svg class="icon-svg" style="width:16px;height:16px;margin-right:6px" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
          Optimize
        </button>
      </div>

      <!-- Crosshair Codes -->
      <div class="section-title">
        <svg class="icon-svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>
        Crosshair Codes
        <span class="player-count">{{csCrosshairs.length}} codes</span>
      </div>
      <div class="card" style="padding:20px;margin-bottom:24px">
        <div class="crosshair-box" v-for="(ch,ci) in csCrosshairs" :key="ci" @click="copyCrosshair(ch.code,ci)">
          <span class="ch-player">{{ch.player}}</span>
          <span class="ch-code">{{ch.code}}</span>
          <span class="ch-copy" :class="{'copied-flash':copiedIdx===ci}">{{copiedIdx===ci ? '✓ Copied' : 'Click to copy'}}</span>
        </div>
      </div>

      <!-- Pro Player Settings -->
      <div class="section-title">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        Pro Player Settings
        <span class="player-count">{{filteredPros.length}} players</span>
      </div>
      <input class="pro-search" type="text" placeholder="Search players..." v-model="proSearch">
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:24px">
        <div class="card pro-player-card" v-for="p in filteredPros" :key="p.name">
          <div class="pro-card-top">
            <div class="pro-avatar">
              <img :src="p.image" :alt="p.name" @error="$event.target.style.display='none'" loading="lazy">
            </div>
            <div class="pro-info">
              <div class="pro-name">{{p.name}}</div>
              <div class="pro-team">{{p.team}}</div>
              <a class="pro-link" :href="'https://prosettings.net/players/'+p.slug+'/'" target="_blank">
                <svg class="icon-svg" style="width:12px;height:12px" viewBox="0 0 24 24"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                prosettings.net
              </a>
            </div>
          </div>
          <div class="pro-stats">
            <div class="pro-stat" v-for="(val,key) in p.settings" :key="key">
              <div class="ps-label">{{key}}</div>
              <div class="ps-value">{{val}}</div>
            </div>
            <div class="pro-stat pro-crosshair-cell" style="grid-column:span 2;cursor:pointer" v-if="p.crosshair" @click="copyCrosshair(p.crosshair,-1)" title="Click to copy crosshair code">
              <div class="ps-label">Crosshair Code</div>
              <div class="ps-value" style="font-family:'Courier New',monospace;font-size:11px;color:var(--cyan);display:flex;align-items:center;gap:6px">{{p.crosshair}} <span style="font-size:10px;color:var(--text3);font-family:inherit">📋</span></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Applied Gaming Tweaks -->
      <div class="section-title">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        Applied Gaming Tweaks
      </div>
      <div class="card" style="padding:20px">
        <div v-if="appliedGamingTweaks.length===0" style="color:var(--text3);font-size:13px">No gaming tweaks applied yet. Click Optimize above to get started.</div>
        <div v-else>
          <div class="hw-row" v-for="t in appliedGamingTweaks" :key="t.row">
            <span class="hw-label">{{t.name}}</span>
            <span class="hw-value" style="color:var(--green);display:flex;align-items:center;gap:4px">
              <svg class="icon-svg" style="width:14px;height:14px" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> Active
            </span>
          </div>
        </div>
      </div>
    </template>

    <!-- ═══════════ SETTINGS ═══════════ -->
    <template v-if="page==='settings'">
      <div class="page-header">
        <h2>Settings</h2>
        <p>Application preferences and information</p>
      </div>

      <div class="card" style="margin-bottom:20px">
        <div class="card-title">General</div>
        <div class="setting-row">
          <div class="sr-info">
            <h4>Administrator Mode</h4>
            <p>{{isAdmin ? 'Running with elevated privileges' : 'Some tweaks require administrator rights'}}</p>
          </div>
          <button class="btn" :class="isAdmin?'btn-green':'btn-outline'" @click="!isAdmin && doRequestAdmin()">
            {{isAdmin ? 'Active' : 'Request Admin'}}
          </button>
        </div>
        <div class="setting-row">
          <div class="sr-info">
            <h4>Verify All Tweaks</h4>
            <p>Check the real system state of all applied tweaks</p>
          </div>
          <button class="btn btn-outline" @click="doVerifyAll">Verify</button>
        </div>
        <div class="setting-row">
          <div class="sr-info">
            <h4>Restore All Defaults</h4>
            <p>Undo every applied tweak and restore system defaults</p>
          </div>
          <button class="btn btn-red" @click="doRestoreAll">Restore</button>
        </div>
      </div>

      <div class="card" style="margin-bottom:20px">
        <div class="card-title">Account</div>
        <div class="setting-row">
          <div class="sr-info">
            <h4>Logged in as</h4>
            <p>{{currentUser}}</p>
          </div>
          <button class="btn btn-outline" @click="doLogout">Sign Out</button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">About</div>
        <div class="hw-row"><span class="hw-label">Version</span><span class="hw-value">5.0.0</span></div>
        <div class="hw-row"><span class="hw-label">Framework</span><span class="hw-value">Qt 6 + Vue.js 3</span></div>
        <div class="hw-row"><span class="hw-label">Engine</span><span class="hw-value">Qt WebEngine + WebChannel</span></div>
        <div class="hw-row"><span class="hw-label">Tweaks</span><span class="hw-value">{{tweaks.length}} available</span></div>
      </div>
    </template>

  </main>

  <!-- ═══════════ BATCH APPLY POPUP ═══════════ -->
  <div class="overlay" v-if="batchActive" @click.self="batchDone && closeBatch()">
    <div class="batch-popup">
      <h3>{{batchDone ? 'Complete!' : 'Applying Tweaks...'}}</h3>
      <div class="progress-bar">
        <div class="fill" :style="{width: batchPct+'%'}"></div>
      </div>
      <div style="font-size:13px;color:var(--text2);margin-bottom:16px">
        {{batchCurrent}} / {{batchTotal}} tweaks
      </div>
      <div style="max-height:320px;overflow-y:auto">
        <div class="batch-item" v-for="(b,i) in batchItems" :key="i">
          <span class="bi-icon" :class="b.state">
            <svg v-if="b.state==='done'" class="icon-svg" style="width:16px;height:16px" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
            <svg v-else-if="b.state==='active'" class="icon-svg" style="width:16px;height:16px" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4" fill="currentColor"/></svg>
            <svg v-else class="icon-svg" style="width:16px;height:16px" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg>
          </span>
          <span class="bi-name">{{b.name}}</span>
          <span class="bi-status" :style="{color: b.state==='done'?'var(--green)':b.state==='active'?'var(--cyan)':'var(--text3)'}">
            {{b.state==='done'?'Done':b.state==='active'?'Applying...':'Pending'}}
          </span>
        </div>
      </div>
      <div style="margin-top:20px;text-align:right" v-if="batchDone">
        <button class="btn btn-cyan" @click="closeBatch">Close</button>
      </div>
    </div>
  </div>

  </template><!-- end loggedIn -->

  <!-- Toast -->
  <div class="toast" v-if="toastMsg" @click="toastMsg=''">{{toastMsg}}</div>
</div>

<script>
const {createApp, ref, computed, onMounted} = Vue;

const app = createApp({
  directives: {
    'click-outside': {
      mounted: function(el, binding){
        el._clickOutside = function(e){
          if(!el.contains(e.target)) binding.value();
        };
        document.addEventListener('click', el._clickOutside);
      },
      unmounted: function(el){
        document.removeEventListener('click', el._clickOutside);
      }
    }
  },
  setup(){
    // ── Auth State ──
    const loggedIn    = ref(false);
    const currentUser = ref('');
    const loginUser   = ref('');
    const loginPass   = ref('');
    const loginError  = ref('');
    const authTab     = ref('login');
    const authLoading = ref(false);
    const licenseKey  = ref('');
    const activateUser = ref('');
    const activatePass = ref('');
    const activateMsg  = ref('');
    const activateSuccess = ref(false);
    const hwidValue   = ref('...');
    const hwidStatus  = ref('none');
    const hwidStatusMsg = ref('');
    const bridge      = ref(null);

    // ── Save Credentials ──
    const saveCredentials = ref(false);

    // Load saved credentials on startup
    (function(){
      try {
        var saved = localStorage.getItem('tweak_save_creds');
        if(saved === 'true'){
          saveCredentials.value = true;
          var u = localStorage.getItem('tweak_cred_user');
          var p = localStorage.getItem('tweak_cred_pass');
          if(u) loginUser.value = u;
          if(p) loginPass.value = p;
        }
      } catch(e){}
    })();

    function onSaveCredsToggle(){
      try {
        if(saveCredentials.value){
          localStorage.setItem('tweak_save_creds', 'true');
        } else {
          localStorage.removeItem('tweak_save_creds');
          localStorage.removeItem('tweak_cred_user');
          localStorage.removeItem('tweak_cred_pass');
        }
      } catch(e){}
    }

    // ── App State ──
    const page      = ref('dashboard');
    const search    = ref('');
    const activeCat = ref('All');
    const sidebarHovered = ref(false);
    const catPinned = ref(false);

    function handleNavClick(p){
      page.value = p.id;
    }

    function selectCategory(c){
      page.value = 'tweaks';
      activeCat.value = c;
      catPinned.value = true;
    }

    function catIcon(cat){
      var icons = {
        'All':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>',
        'FPS':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>',
        'Gaming':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="6" y1="11" x2="10" y2="11"/><line x1="8" y1="9" x2="8" y2="13"/><line x1="15" y1="12" x2="15.01" y2="12"/><line x1="18" y1="10" x2="18.01" y2="10"/><path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.544-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z"/></svg>',
        'Latency':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>',
        'Memory':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></svg>',
        'Network':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>',
        'Power':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>',
        'Privacy':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>',
        'Services':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>',
        'Storage':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>',
        'Visual':'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>'
      };
      return icons[cat] || '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/></svg>';
    }

    const sysinfo    = ref({});
    const monitor    = ref({});
    const scores     = ref({});
    const tweaks     = ref([]);
    const categories = ref([]);
    const isAdmin    = ref(false);
    const appliedCount = ref(0);
    const recommendedCount = ref(0);
    const toastMsg   = ref('');

    // Batch state
    const batchActive  = ref(false);
    const batchDone    = ref(false);
    const batchCurrent = ref(0);
    const batchTotal   = ref(0);
    const batchItems   = ref([]);
    const batchPct     = computed(function(){ return batchTotal.value ? Math.round(batchCurrent.value/batchTotal.value*100) : 0; });

    // Tweak animation & feedback state
    const tweakAnimState = ref({});        // row -> 'applying'|'applied'|'reverted'
    const tweakLogMsg    = ref({});         // row -> message string
    const savedTweakState = ref({});        // row -> true/false (last saved state)
    const hasUnsavedTweaks = ref(false);
    const unsavedCount = ref(0);

    function checkUnsaved(){
      var count = 0;
      tweaks.value.forEach(function(t){
        if(savedTweakState.value[t.row] !== undefined && savedTweakState.value[t.row] !== t.applied){
          count++;
        }
      });
      unsavedCount.value = count;
      hasUnsavedTweaks.value = count > 0;
    }

    function initSavedState(){
      var s = {};
      tweaks.value.forEach(function(t){ s[t.row] = t.applied; });
      savedTweakState.value = s;
      hasUnsavedTweaks.value = false;
      unsavedCount.value = 0;
      // Save to localStorage
      try { localStorage.setItem('tweak_saved_state', JSON.stringify(s)); } catch(e){}
    }

    function loadSavedState(){
      try {
        var raw = localStorage.getItem('tweak_saved_state');
        if(raw){
          savedTweakState.value = JSON.parse(raw);
        }
      } catch(e){}
    }

    // Toggle with visual feedback
    function handleToggleTweak(t){
      var row = t.row;
      var wasApplied = t.applied;
      tweakAnimState.value[row] = 'applying';
      var now = new Date();
      var ts = now.getHours().toString().padStart(2,'0')+':'+now.getMinutes().toString().padStart(2,'0')+':'+now.getSeconds().toString().padStart(2,'0');

      if(bridge.value) bridge.value.toggleTweak(row);

      setTimeout(function(){
        if(wasApplied){
          tweakAnimState.value[row] = 'reverted';
          tweakLogMsg.value[row] = 'Reverted at ' + ts;
          showToast('Reverted: ' + t.name);
        } else {
          tweakAnimState.value[row] = 'applied';
          tweakLogMsg.value[row] = 'Applied at ' + ts;
          showToast('Applied: ' + t.name);
        }
        checkUnsaved();
        setTimeout(function(){ tweakAnimState.value[row] = ''; }, 800);
      }, 300);
    }

    function tweakStatusClass(t){
      if(tweakAnimState.value[t.row]==='applying') return 'ts-applying';
      if(savedTweakState.value[t.row] !== undefined && savedTweakState.value[t.row] !== t.applied) return 'ts-unsaved';
      if(t.applied) return 'ts-saved';
      return '';
    }
    function tweakStatusText(t){
      if(tweakAnimState.value[t.row]==='applying') return 'Applying...';
      if(savedTweakState.value[t.row] !== undefined && savedTweakState.value[t.row] !== t.applied) return 'Unsaved';
      if(t.applied) return 'Active';
      return '';
    }

    function saveTweakChanges(){
      initSavedState();
      showToast('All changes saved!');
    }

    function discardTweakChanges(){
      // Revert tweaks to their saved state
      tweaks.value.forEach(function(t){
        if(savedTweakState.value[t.row] !== undefined && savedTweakState.value[t.row] !== t.applied){
          if(bridge.value) bridge.value.toggleTweak(t.row);
        }
      });
      showToast('Changes discarded');
      setTimeout(function(){ hasUnsavedTweaks.value = false; unsavedCount.value = 0; }, 500);
    }

    function confirmRevertAll(){
      doRestoreAll();
      setTimeout(function(){ initSavedState(); }, 1000);
    }

    // SVG icon paths for nav
    const pages = [
      {id:'dashboard', label:'Dashboard', svg:'<svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>'},
      {id:'tweaks',    label:'Optimizations', svg:'<svg class="icon-svg" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>'},
      {id:'boost',     label:'Boost Up', svg:'<svg class="icon-svg" viewBox="0 0 24 24"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>'},
      {id:'games',     label:'CS2', svg:'<svg class="icon-svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="22" y1="12" x2="18" y2="12"/><line x1="6" y1="12" x2="2" y2="12"/><line x1="12" y1="6" x2="12" y2="2"/><line x1="12" y1="22" x2="12" y2="18"/></svg>'},
    ];

    // CS2 Pro player data with prosettings.net slugs
    const copiedIdx = ref(-1);

    function copyCrosshair(code, idx){
      navigator.clipboard.writeText(code).then(function(){
        copiedIdx.value = idx;
        showToast('Crosshair code copied!');
        setTimeout(function(){ copiedIdx.value = -1; }, 1500);
      });
    }

    const csCrosshairs = [
          {player:'s1mple', code:'CSGO-E8xcE-27Lmw-2ipNt-3HZvp-pevvE'},
          {player:'ZywOo', code:'CSGO-E9RyF-Mv3Uv-67Cp3-GtHxR-k8aYO'},
          {player:'NiKo', code:'CSGO-LfYUV-BtxVq-iAmCV-DpFQZ-5eRqJ'},
          {player:'donk', code:'CSGO-odYLp-isvFB-KOuxt-PsGZe-PU9vO'},
          {player:'Twistzz', code:'CSGO-JU2jV-vzchu-svymm-AjmBN-4jw5G'},
          {player:'electronic', code:'CSGO-XxVXc-qLTMh-djJcV-2RPcf-WROpP'},
          {player:'b1t', code:'CSGO-RGiBp-OXkpB-BqZwB-BRBvu-zwsyM'},
          {player:'blameF', code:'CSGO-GkbuB-AoRSV-WSRTX-3uku3-UTGOP'},
          {player:'Magisk', code:'CSGO-u9zTy-WMY5r-o8par-X6eM3-kJ5mA'},
          {player:'cadiaN', code:'CSGO-qkkHe-wUdL7-HvPrQ-7q4PF-htuWK'},
          {player:'stavn', code:'CSGO-yikLL-77yEK-NWkyj-WJn8u-dptiB'},
          {player:'jabbi', code:'CSGO-2iS5N-77Zdo-UjdRV-vPshA-ZbmbN'},
          {player:'TeSeS', code:'CSGO-uSeWF-F4v3i-yzDJ7-OEThH-CFCEB'},
          {player:'sjuush', code:'CSGO-6CrJG-XTmKy-xhYoP-kcMPU-He4NF'},
          {player:'jL', code:'CSGO-WDGNY-oKrfi-N2E4n-XyDEY-f2XDJ'},
          {player:'jks', code:'CSGO-VzkXX-2Uo4N-Q77fo-aCpnB-XyqRP'},
          {player:'EliGE', code:'CSGO-kuotc-J8r2V-bpfZh-VB585-GbvvE'},
          {player:'NAF', code:'CSGO-CqJLs-FtDeV-zyfwL-Q39tt-OYBpF'},
          {player:'Stewie2k', code:'CSGO-r3XBE-ySAhm-GuHRz-CfiVC-Vc4NF'},
          {player:'autimatic', code:'CSGO-cYLt8-mWhnx-PiYYY-tjBNt-TGpEM'},
          {player:'Ax1Le', code:'CSGO-k3yQ7-F5aqK-sVKQd-ZUi4K-z26KQ'},
          {player:'Perfecto', code:'CSGO-LdXHk-hatWX-JjEa8-tuLDN-5tbJD'},
          {player:'Spinx', code:'CSGO-9Cmqe-AtNsK-erz4T-qBVCE-8kwjN'},
          {player:'mezii', code:'CSGO-39YYV-RFmuF-QpcOt-2zQFu-J9T8N'},
          {player:'huNter', code:'CSGO-UZZrY-2yHCw-8URMu-dHkb6-5pZQM'}
        ];

    const csAllPros = [
          {name:'s1mple', slug:'s1mple', team:'BC.Game', image:'https://prosettings.net/wp-content/uploads/s1mple-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-E8xcE-27Lmw-2ipNt-3HZvp-pevvE', settings:{'DPI':'400','Sensitivity':'3.09','eDPI':'1236','Resolution':'1280×960'}},
          {name:'ZywOo', slug:'zywoo', team:'Team Vitality', image:'https://prosettings.net/wp-content/uploads/zywoo-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-E9RyF-Mv3Uv-67Cp3-GtHxR-k8aYO', settings:{'DPI':'400','Sensitivity':'2','eDPI':'800.00','Resolution':'1280×960'}},
          {name:'NiKo', slug:'niko', team:'Falcons Esports', image:'https://prosettings.net/wp-content/uploads/niko-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-LfYUV-BtxVq-iAmCV-DpFQZ-5eRqJ', settings:{'DPI':'800','Sensitivity':'1','eDPI':'800.00','Resolution':'1280×768'}},
          {name:'donk', slug:'donk', team:'Team Spirit', image:'https://prosettings.net/wp-content/uploads/donk-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-odYLp-isvFB-KOuxt-PsGZe-PU9vO', settings:{'DPI':'800','Sensitivity':'1.25','eDPI':'1000','Resolution':'1280×960'}},
          {name:'m0NESY', slug:'m0nesy', team:'Falcons Esports', image:'https://prosettings.net/wp-content/uploads/m0nesy-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'800','Sensitivity':'1.15','eDPI':'920.00','Resolution':'1280×960'}},
          {name:'ropz', slug:'ropz', team:'Team Vitality', image:'https://prosettings.net/wp-content/uploads/ropz-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'400','Sensitivity':'1.77','eDPI':'708','Resolution':'1920×1080'}},
          {name:'Twistzz', slug:'twistzz', team:'FaZe Clan', image:'https://prosettings.net/wp-content/uploads/twistzz-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-JU2jV-vzchu-svymm-AjmBN-4jw5G', settings:{'DPI':'400','Sensitivity':'1.59','eDPI':'636.00','Resolution':'1280×960'}},
          {name:'electronic', slug:'electronic', team:'BC.Game', image:'https://prosettings.net/wp-content/uploads/electronic-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-XxVXc-qLTMh-djJcV-2RPcf-WROpP', settings:{'DPI':'400','Sensitivity':'2.2','eDPI':'880.00','Resolution':'1280×1024'}},
          {name:'b1t', slug:'b1t', team:'Natus Vincere', image:'https://prosettings.net/wp-content/uploads/b1t-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-RGiBp-OXkpB-BqZwB-BRBvu-zwsyM', settings:{'DPI':'400','Sensitivity':'1.65','eDPI':'660.00','Resolution':'1280×960'}},
          {name:'rain', slug:'rain', team:'100 Thieves', image:'https://prosettings.net/wp-content/uploads/rain-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'800','Sensitivity':'0.95','eDPI':'760.00','Resolution':'1280×960'}},
          {name:'broky', slug:'broky', team:'FaZe Clan', image:'https://prosettings.net/wp-content/uploads/broky-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'400','Sensitivity':'2.57','eDPI':'1028.00','Resolution':'1280×960'}},
          {name:'frozen', slug:'frozen', team:'FaZe Clan', image:'https://prosettings.net/wp-content/uploads/frozen-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'400','Sensitivity':'2','eDPI':'800','Resolution':'1280×960'}},
          {name:'blameF', slug:'blamef', team:'BIG', image:'https://prosettings.net/wp-content/uploads/blamef-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-GkbuB-AoRSV-WSRTX-3uku3-UTGOP', settings:{'DPI':'400','Sensitivity':'1.6','eDPI':'640.00','Resolution':'1280×960'}},
          {name:'Magisk', slug:'magisk', team:'Free Agent', image:'https://prosettings.net/wp-content/uploads/magisk-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-u9zTy-WMY5r-o8par-X6eM3-kJ5mA', settings:{'DPI':'800','Sensitivity':'1','eDPI':'800.00','Resolution':'1280×960'}},
          {name:'dupreeh', slug:'dupreeh', team:'Retired', image:'https://prosettings.net/wp-content/uploads/dupreeh-200x200-fitcontain-q99-gb283-s1.png', crosshair:'', settings:{'DPI':'400','Sensitivity':'1.77','eDPI':'708.00','Resolution':'1280×800'}},
          {name:'gla1ve', slug:'gla1ve', team:'100 Thieves', image:'https://prosettings.net/wp-content/uploads/gla1ve-200x200-fitcontain-q99-gb283-s1.png', crosshair:'', settings:{'DPI':'400','Sensitivity':'1.8','eDPI':'720','Resolution':'1280×960'}},
          {name:'Xyp9x', slug:'xyp9x', team:'MOUZ', image:'https://prosettings.net/wp-content/uploads/xyp9x-200x200-fitcontain-q99-gb283-s1.png', crosshair:'', settings:{'DPI':'400','Sensitivity':'2','eDPI':'800','Resolution':'1680×1050'}},
          {name:'cadiaN', slug:'cadian', team:'OG Esports', image:'https://prosettings.net/wp-content/uploads/cadian-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-qkkHe-wUdL7-HvPrQ-7q4PF-htuWK', settings:{'DPI':'400','Sensitivity':'2.3','eDPI':'920.00','Resolution':'1280×960'}},
          {name:'stavn', slug:'stavn', team:'Free Agent', image:'https://prosettings.net/wp-content/uploads/stavn-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-yikLL-77yEK-NWkyj-WJn8u-dptiB', settings:{'DPI':'400','Sensitivity':'2.5','eDPI':'1000.00','Resolution':'800×600'}},
          {name:'jabbi', slug:'jabbi', team:'Astralis', image:'https://prosettings.net/wp-content/uploads/jabbi-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-2iS5N-77Zdo-UjdRV-vPshA-ZbmbN', settings:{'DPI':'800','Sensitivity':'0.90','eDPI':'720','Resolution':'1280×960'}},
          {name:'TeSeS', slug:'teses', team:'Falcons Esports', image:'https://prosettings.net/wp-content/uploads/teses-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-uSeWF-F4v3i-yzDJ7-OEThH-CFCEB', settings:{'DPI':'1600','Sensitivity':'0.5','eDPI':'800.00','Resolution':'1024×768'}},
          {name:'sjuush', slug:'sjuush', team:'Ninjas in Pyjamas', image:'https://prosettings.net/wp-content/uploads/sjuush-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-6CrJG-XTmKy-xhYoP-kcMPU-He4NF', settings:{'DPI':'800','Sensitivity':'1.11','eDPI':'888.00','Resolution':'1440×1080'}},
          {name:'HooXi', slug:'hooxi', team:'Astralis', image:'https://prosettings.net/wp-content/uploads/hooxi-200x200-fitcontain-q99-gb283-s1.png', crosshair:'', settings:{'DPI':'800','Sensitivity':'0.9','eDPI':'720.00','Resolution':'1280×768'}},
          {name:'w0nderful', slug:'w0nderful', team:'Natus Vincere', image:'https://prosettings.net/wp-content/uploads/w0nderful-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'400','Sensitivity':'2.6','eDPI':'1040.00','Resolution':'1280×960'}},
          {name:'jL', slug:'jl', team:'Content Creator', image:'https://prosettings.net/wp-content/uploads/jl-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-WDGNY-oKrfi-N2E4n-XyDEY-f2XDJ', settings:{'DPI':'800','Sensitivity':'1','eDPI':'800','Resolution':'1280×1024'}},
          {name:'Aleksib', slug:'aleksib', team:'Natus Vincere', image:'https://prosettings.net/wp-content/uploads/aleksib-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'800','Sensitivity':'1.06','eDPI':'848.00','Resolution':'1440×1080'}},
          {name:'jks', slug:'jks', team:'FlyQuest', image:'https://prosettings.net/wp-content/uploads/jks-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-VzkXX-2Uo4N-Q77fo-aCpnB-XyqRP', settings:{'DPI':'400','Sensitivity':'1.85','eDPI':'740.00','Resolution':'1920×1080'}},
          {name:'EliGE', slug:'elige', team:'Team Liquid', image:'https://prosettings.net/wp-content/uploads/elige-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-kuotc-J8r2V-bpfZh-VB585-GbvvE', settings:{'DPI':'1600','Sensitivity':'0.74','eDPI':'1184','Resolution':'1680×1050'}},
          {name:'NAF', slug:'naf', team:'Team Liquid', image:'https://prosettings.net/wp-content/uploads/naf-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-CqJLs-FtDeV-zyfwL-Q39tt-OYBpF', settings:{'DPI':'800','Sensitivity':'0.8','eDPI':'640.00','Resolution':'1280×960'}},
          {name:'Stewie2k', slug:'stewie2k', team:'Free Agent', image:'https://prosettings.net/wp-content/uploads/stewie2k-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-r3XBE-ySAhm-GuHRz-CfiVC-Vc4NF', settings:{'DPI':'800','Sensitivity':'1.25','eDPI':'1000.00','Resolution':'1280×960'}},
          {name:'autimatic', slug:'autimatic', team:'NRG', image:'https://prosettings.net/wp-content/uploads/autimatic-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-cYLt8-mWhnx-PiYYY-tjBNt-TGpEM', settings:{'DPI':'800','Sensitivity':'1.125','eDPI':'900','Resolution':'1920×1080'}},
          {name:'Ax1Le', slug:'ax1le', team:'BetBoom Team', image:'https://prosettings.net/wp-content/uploads/ax1le-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-k3yQ7-F5aqK-sVKQd-ZUi4K-z26KQ', settings:{'DPI':'800','Sensitivity':'1.50','eDPI':'1200','Resolution':'1280×960'}},
          {name:'HObbit', slug:'hobbit', team:'1WIN', image:'https://prosettings.net/wp-content/uploads/hobbit-200x200-fitcontain-q99-gb283-s1.png', crosshair:'', settings:{'DPI':'800','Sensitivity':'1.25','eDPI':'1000.00','Resolution':'1280×960'}},
          {name:'Perfecto', slug:'perfecto', team:'Virtus.pro', image:'https://prosettings.net/wp-content/uploads/perfecto-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-LdXHk-hatWX-JjEa8-tuLDN-5tbJD', settings:{'DPI':'800','Sensitivity':'1.2','eDPI':'960.00','Resolution':'1280×960'}},
          {name:'fame', slug:'fame', team:'Virtus.pro', image:'https://prosettings.net/wp-content/uploads/fame-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'800','Sensitivity':'1.10','eDPI':'880','Resolution':'1280×960'}},
          {name:'Spinx', slug:'spinx', team:'MOUZ', image:'https://prosettings.net/wp-content/uploads/spinx-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-9Cmqe-AtNsK-erz4T-qBVCE-8kwjN', settings:{'DPI':'800','Sensitivity':'1.23','eDPI':'984.00','Resolution':'1280×960'}},
          {name:'mezii', slug:'mezii', team:'Team Vitality', image:'https://prosettings.net/wp-content/uploads/mezii-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'CSGO-39YYV-RFmuF-QpcOt-2zQFu-J9T8N', settings:{'DPI':'400','Sensitivity':'2.2','eDPI':'880.00','Resolution':'1280×960'}},
          {name:'huNter', slug:'hunter', team:'G2 Esports', image:'https://prosettings.net/wp-content/uploads/hunter-200x200-fitcontain-q99-gb283-s1.png', crosshair:'CSGO-UZZrY-2yHCw-8URMu-dHkb6-5pZQM', settings:{'DPI':'800','Sensitivity':'1.25','eDPI':'1000.00','Resolution':'1350×1080'}},
          {name:'nexa', slug:'nexa', team:'Free Agent', image:'https://prosettings.net/wp-content/uploads/nexa-200x200-fitcontain-q99-gb283-s1.webp', crosshair:'', settings:{'DPI':'800','Sensitivity':'1.25','eDPI':'1000.00','Resolution':'1024×768'}}
        ];

    const proSearch = ref('');
    const filteredPros = computed(function(){
      if(!proSearch.value) return csAllPros;
      var q = proSearch.value.toLowerCase();
      return csAllPros.filter(function(p){ return p.name.toLowerCase().includes(q) || p.team.toLowerCase().includes(q); });
    });

    // Keep gameProfiles for applyGameProfile compatibility
    const gameProfiles = [{name:'CS2', cats:['Gaming','Network']}];

    // ── Computed ──
    const filteredTweaks = computed(function(){
      var list = tweaks.value;
      if(activeCat.value!=='All') list = list.filter(function(t){ return t.category===activeCat.value; });
      if(search.value){
        var q = search.value.toLowerCase();
        list = list.filter(function(t){ return t.name.toLowerCase().includes(q) || t.description.toLowerCase().includes(q) || t.category.toLowerCase().includes(q); });
      }
      return list;
    });

    const unappliedVisible = computed(function(){ return filteredTweaks.value.filter(function(t){ return !t.applied; }); });
    const appliedGamingTweaks = computed(function(){ return tweaks.value.filter(function(t){ return t.applied && t.category==='Gaming'; }); });

    function tweakCountByCat(c){ return tweaks.value.filter(function(t){ return t.category===c; }).length; }

    // ── Toast ──
    var toastTimer = null;
    function showToast(msg){
      toastMsg.value = msg;
      clearTimeout(toastTimer);
      toastTimer = setTimeout(function(){ toastMsg.value = ''; }, 3000);
    }

    // ── Auth ──
    function doLogin(){
      loginError.value = '';
      if(!loginUser.value || !loginPass.value){
        loginError.value = 'Please enter username and password';
        return;
      }
      if(!bridge.value){ loginError.value = 'Backend not available'; return; }
      authLoading.value = true;
      bridge.value.loginLicense(loginUser.value, loginPass.value);
    }

    // ── Debounced HWID status check ──
    var hwidCheckTimer = null;
    function onLoginUserInput(){
      hwidStatus.value = 'none';
      hwidStatusMsg.value = '';
      clearTimeout(hwidCheckTimer);
      var u = loginUser.value.trim();
      if(!u || !bridge.value) return;
      hwidCheckTimer = setTimeout(function(){
        bridge.value.checkHwidStatus(u);
      }, 600);
    }

    function doActivate(){
      activateMsg.value = '';
      activateSuccess.value = false;
      if(!licenseKey.value || !activateUser.value || !activatePass.value){
        activateMsg.value = 'Please fill in all fields';
        return;
      }
      if(!bridge.value){ activateMsg.value = 'Backend not available'; return; }
      authLoading.value = true;
      bridge.value.activateLicense(licenseKey.value, activateUser.value, activatePass.value);
    }

    function doLogout(){
      loggedIn.value = false;
      currentUser.value = '';
      // Keep credentials if save is on, clear otherwise
      if(!saveCredentials.value){
        loginUser.value = '';
        loginPass.value = '';
        try {
          localStorage.removeItem('tweak_cred_user');
          localStorage.removeItem('tweak_cred_pass');
        } catch(e){}
      } else {
        loginPass.value = '';
      }
      loginError.value = '';
      activateMsg.value = '';
      licenseKey.value = '';
      activateUser.value = '';
      activatePass.value = '';
      page.value = 'dashboard';
      catPinned.value = false;
    }

    // ── Data Loaders ──
    function refreshAll(){
      if(!bridge.value) return;
      bridge.value.getSystemInfo(function(d){ sysinfo.value = d; });
      bridge.value.getMonitorData(function(d){ monitor.value = d; });
      bridge.value.getScoreData(function(d){ scores.value = d; });
      bridge.value.getTweaks(function(d){ tweaks.value = d; });
      bridge.value.getCategories(function(d){ categories.value = d; });
      bridge.value.getAppliedCount(function(v){ appliedCount.value = v; });
      bridge.value.getRecommendedCount(function(v){ recommendedCount.value = v; });
      bridge.value.getIsAdmin(function(v){ isAdmin.value = v; });
    }

    function refreshTweaks(){
      if(!bridge.value) return;
      bridge.value.getTweaks(function(d){
        tweaks.value = d;
        checkUnsaved();
      });
      bridge.value.getAppliedCount(function(v){ appliedCount.value = v; });
    }

    // ── Actions ──
    function toggleTweak(row){ if(bridge.value) bridge.value.toggleTweak(row); }
    // toggleTweak kept for batch, handleToggleTweak used for individual UI toggle
    function doApplyRecommended(){ if(bridge.value){ bridge.value.applyRecommended(); showToast('Applying recommended tweaks...'); }}
    function doApplyGaming(){ if(bridge.value){ bridge.value.applyAllGaming(); showToast('Applying gaming tweaks...'); }}
    function doRestoreAll(){ if(bridge.value){ bridge.value.restoreAll(); showToast('Restoring all defaults...'); }}
    function doClearTemp(){ if(bridge.value){ bridge.value.clearTempFiles(); showToast('Clearing temp files...'); }}
    function doFlushDns(){ if(bridge.value){ bridge.value.flushDns(); showToast('Flushing DNS cache...'); }}
    function doVerifyAll(){ if(bridge.value){ bridge.value.verifyAllTweaks(); showToast('Verifying all tweaks...'); }}
    function doRequestAdmin(){ if(bridge.value) bridge.value.requestAdmin(); }

    // Batch
    function startBatchApply(){
      var rows = unappliedVisible.value.map(function(t){ return t.row; });
      if(rows.length===0) return;
      runBatch(rows);
    }
    function startFullBatchApply(){
      var rows = tweaks.value.filter(function(t){ return !t.applied; }).map(function(t){ return t.row; });
      if(rows.length===0) return;
      runBatch(rows);
    }
    function runBatch(rows){
      batchActive.value = true;
      batchDone.value = false;
      batchCurrent.value = 0;
      batchTotal.value = rows.length;
      batchItems.value = rows.map(function(r){
        var tw = tweaks.value.find(function(t){ return t.row===r; });
        return {name: tw ? tw.name : 'Tweak #'+r, state:'pending'};
      });
      if(batchItems.value.length > 0) batchItems.value[0].state = 'active';
      bridge.value.applyBatch(rows);
    }
    function closeBatch(){ batchActive.value = false; }
    function applyGameProfile(cats){
      var rows = tweaks.value.filter(function(t){ return !t.applied && cats.indexOf(t.category) >= 0; }).map(function(t){ return t.row; });
      if(rows.length===0){ showToast('All tweaks for this profile already applied!'); return; }
      runBatch(rows);
    }

    // ── Init ──
    onMounted(function(){
      new QWebChannel(qt.webChannelTransport, function(channel){
        bridge.value = channel.objects.bridge;

        // Fetch HWID for the activate tab
        bridge.value.getHwid(function(h){ hwidValue.value = h || '...'; });

        // Auto-login if credentials are saved
        if(saveCredentials.value && loginUser.value && loginPass.value){
          authLoading.value = true;
          bridge.value.loginLicense(loginUser.value, loginPass.value);
        }

        // License login result
        bridge.value.loginResult.connect(function(success, message){
          authLoading.value = false;
          if(success){
            loggedIn.value = true;
            currentUser.value = loginUser.value;
            // Save credentials if checkbox is checked
            try {
              if(saveCredentials.value){
                localStorage.setItem('tweak_cred_user', loginUser.value);
                localStorage.setItem('tweak_cred_pass', loginPass.value);
                localStorage.setItem('tweak_save_creds', 'true');
              }
            } catch(e){}
            loginPass.value = '';
            loginError.value = '';
            refreshAll();
            // Initialize saved state after login
            setTimeout(function(){
              if(Object.keys(savedTweakState.value).length === 0) initSavedState();
            }, 1500);
          } else {
            loginError.value = message || 'Login failed';
          }
        });

        // License activation result
        bridge.value.activateResult.connect(function(success, message){
          authLoading.value = false;
          activateSuccess.value = success;
          activateMsg.value = message || '';
          if(success){
            // Auto-switch to login tab after activation
            setTimeout(function(){
              authTab.value = 'login';
              loginUser.value = activateUser.value;
              activateUser.value = '';
              activatePass.value = '';
              licenseKey.value = '';
              activateMsg.value = '';
            }, 2000);
          }
        });

        // HWID status indicator result
        bridge.value.hwidStatusResult.connect(function(status, message){
          hwidStatus.value = status;
          hwidStatusMsg.value = message || '';
        });

        bridge.value.tweaksChanged.connect(function(){ refreshTweaks(); });

        // Load saved tweak state from localStorage
        loadSavedState();
        bridge.value.monitorUpdated.connect(function(){
          bridge.value.getMonitorData(function(d){ monitor.value = d; });
        });
        bridge.value.batchProgress.connect(function(cur, total, name, status){
          batchCurrent.value = cur;
          batchTotal.value = total;
          for(var i = 0; i < batchItems.value.length; i++){
            if(i < cur) batchItems.value[i].state = 'done';
            else if(i === cur) batchItems.value[i].state = 'active';
            else batchItems.value[i].state = 'pending';
          }
        });
        bridge.value.batchComplete.connect(function(){
          batchDone.value = true;
          batchCurrent.value = batchTotal.value;
          for(var i = 0; i < batchItems.value.length; i++){
            batchItems.value[i].state = 'done';
          }
          refreshTweaks();
          showToast('Batch complete! Don\'t forget to Save.');
        });
      });
    });

    return {
      loggedIn, currentUser, loginUser, loginPass, loginError, doLogin, doLogout,
      authTab, authLoading, licenseKey, activateUser, activatePass,
      activateMsg, activateSuccess, hwidValue, hwidStatus, hwidStatusMsg,
      doActivate, onLoginUserInput, saveCredentials, onSaveCredsToggle,
      bridge, page, pages, search, activeCat,
      sidebarHovered, catPinned, handleNavClick, selectCategory, catIcon,
      sysinfo, monitor, scores, tweaks, categories,
      isAdmin, appliedCount, recommendedCount,
      filteredTweaks, unappliedVisible, appliedGamingTweaks,
      tweakCountByCat,
      tweakAnimState, tweakLogMsg, hasUnsavedTweaks, unsavedCount,
      handleToggleTweak, tweakStatusClass, tweakStatusText,
      saveTweakChanges, discardTweakChanges, confirmRevertAll,
      gameProfiles, csCrosshairs, csAllPros, proSearch, filteredPros, copiedIdx, copyCrosshair, toastMsg,
      toggleTweak, doApplyRecommended, doApplyGaming, doRestoreAll,
      doClearTemp, doFlushDns, doVerifyAll, doRequestAdmin,
      startBatchApply, startFullBatchApply, applyGameProfile, closeBatch,
      batchActive, batchDone, batchCurrent, batchTotal, batchItems, batchPct,
    };
  }
});

app.mount('#app');
</script>
</body>
</html>
